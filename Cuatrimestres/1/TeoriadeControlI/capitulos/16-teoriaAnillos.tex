%-------------------------------------------------------------------------------
%	EMPIEZA CAPITULO
%-------------------------------------------------------------------------------

\chapter{Sistemas  lineales bajo el punto de vista de teoria de anillos}

%-------------------------------------------------------------------------------
%	EMPIEZA SECCION
%-------------------------------------------------------------------------------

    \section{Anillos conmutativos euclidianos}

        \begin{definicion}
            Un anillo es una estructura algebraica de un conjunto $\mathcal{A}$, provisto de dos operaciones a las que les llamamos suma $(+)$ y producto $(\cdot)$, con las siguientes propiedades:

            \begin{enumerate}
                \item $(\mathcal{A}, +)$ es un grupo abeliano

                \begin{enumerate}
                    \item $a, b, \in \mathcal{A} \implies a + b \in \mathcal{A}$
                    \item $a, b, c \in \mathcal{A} \implies a + (b + c) = (a + b) + c$
                    \item $\exists ! 0 \in \mathcal{A} \text{ tal que } 0 + a = a + 0 = a \quad \forall a \in \mathcal{A}$
                    \item $\forall a \in \mathcal{A} \exists \bar{a} \in \mathcal{A} \text{ tal que } a + \bar{a} = 0 \quad \bar{a} = -a \quad b + \bar{a} = b - a$
                    \item $a, b \in \mathcal{A} \implies a + b = b + a$
                \end{enumerate}

                \item $(\mathcal{A}, \cdot)$ es un semigrupo con unidad

                \begin{enumerate}
                    \item $a, b \in \mathcal{A} \implies a \cdot b \in \mathcal{A}$
                    \item $a, b, c \in \mathcal{A} \implies a \cdot (b \cdot c) = (a \cdot b) \cdot c$
                    \item $\exists ! 1 \in \mathcal{A} \text{ tal que } 1 \cdot a  = a \cdot 1 = a \quad \forall a \in \mathcal{A}$
                \end{enumerate}

                \item Distributividad de $(+)$ y $(\cdot)$

                \begin{enumerate}
                    \item $a \cdot (b + c) = a \cdot b + a \cdot c$
                    \item $(a + b) \cdot c = a \cdot c + b \cdot c$
                \end{enumerate}

                \item Propiedad Euclidiana

                Existe una función euclidiana llamada grado, $\grado : \mathcal{A} \to \mathbb{Z}^+$, tal que para todo par de elementos $a, b \in \mathcal{A}$, existen $c, r \in \mathcal{A}$ tales que:

                \begin{equation*}
                    a = b \cdot c + r
                \end{equation*}

                con $\grado{r} < \grado{b}$ o $\grado{r} = 0$.

                A esto se le conoce como el algoritmo de la división de Euclides.
                \item Conmutatividad de $(\cdot)$

                Si $a \cdot b = b \cdot a \quad \forall a, b \in \mathcal{A}$ se dice que el anillo $\mathcal{A}$ es conmutativo.
            \end{enumerate}

            De aquí en adelante a los anillos euclidianos conmutativos les llamaremos simplemente anillos.

            Esta estructura es la generalización de los numeros enteros. La función grado del anillo de los numeros enteros corresponde al valor absoluto y en el anillo de los polinomios corresponde al grado de los polinomios.
        \end{definicion}

        Dos nociones importantes de la teoría de anillos es el máximo común divisor y primos relativos.

        \begin{definicion}
            Dados $a, b, c \in \mathcal{A}$, siendo $\mathcal{A}$ un anillo conmutativo, entonces tendremos:

            \begin{enumerate}
                \item $b \ne 0$ es un divisor de $a$ si existe $m \in \mathcal{A}$ tal que:

                \begin{equation*}
                    a = b \cdot m
                \end{equation*}

                en dado caso se escribe $\sfrac{b}{a}$ y se dice que $b$ divide a $a$.

                \item $c \in \mathcal{A}$ es el máximo común divisor de $a, b \in \mathcal{A}$ si:

                \begin{enumerate}
                    \item $c$ es divisor de $a$ y $b$, es decir $\sfrac{c}{a}$ y $\sfrac{c}{b}$, es decir, existen $m, n \in \mathcal{A}$ tal que:

                    \begin{equation*}
                        a = m \cdot c \quad y \quad b = n \cdot c
                    \end{equation*}

                    \item Cualquier otro divisor de $a$ y $b$ es tambien divisor de $c$, es decir, $\sfrac{d}{a}$ y $\sfrac{d}{b}$ implica que $\sfrac{d}{c}$, es decir, existe $l \in \mathcal{A}$ tal que:

                    \begin{equation*}
                        c = l \cdot d
                    \end{equation*}

                    y se escribe como $c = (a, b)$.
                \end{enumerate}
            \end{enumerate}
        \end{definicion}

        \begin{lema}
            Si $a, b \in \mathcal{A}$, $a \ne 0$ y $b \ne 0$, entonces existe $(a, b)$. Ademas existen $m, n \in \mathcal{A}$ tales que:

            \begin{equation}
                m \cdot a + n \cdot b = (a, b)
            \end{equation}
        \end{lema}

        \begin{definicion}
            Sean $a, b \in \mathcal{A}$, $a$ y $b$ serán primos relativos si $(a, b) = 1$.
        \end{definicion}

        \begin{lema}
            Sean $a, b, c \in \mathcal{A}$ con $(a, b) = 1$, entonces:

            \begin{equation}
                \exists m_0, n_0 \in \mathcal{A} \text{ tal que } m_0 a + n_0 b = 1
            \end{equation}

            \begin{equation}  \label{eq:anillos0}
                \exists m, n \in \mathcal{A} \text{ tal que } m a + n b = c
            \end{equation}

            A la primera ecuación la conocemos como la identidad de Bezout y a la segunda como ecuación Diofantina.
        \end{lema}

        \begin{definicion}
            El anillo de los polinomios, en el indeterminado $s$, y con coeficientes reales se le denomina $\mathbb{R}[s]$, siendo su función $\grado$, el grado de los polinomios.

            El anillo de fracciones propias de polinomios, en el indeterminado $s$, y con coeficientes reales se le denomina $\mathbb{R}(s)$, siendo su función $\grado$, el grado relativo de la función, es decir, para una función $f(s) = \frac{a(s)}{b(s)} \in \mathbb{R}(s)$ con $a(s), b(s) \in \mathbb{R}[s]$, $b \ne 0$ y $\grado{a(s)} \le \grado{b(s)}$, el grado relativo es:

            \begin{equation*}
                \grado{f(s)} = \grado{b(s)} - \grado{a(s)}
            \end{equation*}
        \end{definicion}

%-------------------------------------------------------------------------------
%	EMPIEZA SECCION
%-------------------------------------------------------------------------------

    \newpage
    \section{Representación de sistemas lineales en $\mathbb{R}[s]$}

        Sea un sistema lineal representado por la ecuación diferencial ordinaria:

        \begin{equation} \label{eq:anillos1}
            M \left( \frac{d}{dt} \right) y(t) = N \left( \frac{d}{dt} \right) u(t)
        \end{equation}

        donde $M(s), N(s) \in \mathbb{R}[s]$ y $\grado{M(s)} \ge \grado{N(s)}$, $y(t)$ es la salida y $u(t)$ es la señal de control.

%-------------------------------------------------------------------------------

        \subsection{Asignación de polos con cancelación de ceros}

            \begin{problema}
                Se desea encontrar una ley de control lineal tal que el sistema en lazo cerrado este representado por la siguiente ecuación diferencial ordinaria siguiente:

                \begin{equation}
                    Q_E \left( \frac{d}{dt} \right) y(t) = r(t)
                \end{equation}

                donde $Q_E(s) \in \mathbb{R}[s]$ es un polinomio Hurwitz y $r(t)$ es la señal de referencia.
            \end{problema}

            Este problema se resuelve utilizando el algoritmo de la división de Euclides. Para esto se propone la siguiente ley de control lineal:

            \begin{equation} \label{eq:anillos2}
                \mathcal{S} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) = - \mathcal{R} \left( \frac{d}{dt} \right) y(t) + r(t)
            \end{equation}

            donde $\mathcal{S}(s), \mathcal{R}(s) \in \mathbb{R}[s]$, son solución del algoritmo de la división de Euclides, es decir:

            \begin{equation} \label{eq:anillos3}
                Q_E(s) = \mathcal{S}(s) M(s) + \mathcal{R}(s)
            \end{equation}

            donde $\grado{\mathcal{R}(s)} < \grado{M(s)}$ o $\grado{\mathcal{R}(s)} = 0$.

            En efecto, aplicando el operador $\mathcal{S} \left( \frac{d}{dt} \right)$ a la ecuación~\ref{eq:anillos1} se obtiene que:

            \begin{equation*}
                \mathcal{S} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) y(t) = \mathcal{S} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t)
            \end{equation*}

            y sustituyendo la ecuación~\ref{eq:anillos2} tenemos:

            \begin{eqnarray*}
                \mathcal{S} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) y(t) & = & -\mathcal{R} \left( \frac{d}{dt} \right) y(t) + r(t) \\
                \left( \mathcal{S} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) + \mathcal{R} \left( \frac{d}{dt} \right) \right) y(t) & = & r(t)
            \end{eqnarray*}

            por lo que la ecuación~\ref{eq:anillos3} implica:

            \begin{equation*}
                Q_E \left( \frac{d}{dt} \right) y(t) = r(t)
            \end{equation*}

            Con respecto a la dinámica de la entrada, podemos aplicar el operador $\mathcal{R} \left( \frac{d}{dt} \right)$ a la ecuación~\ref{eq:anillos1} y obtener:

            \begin{eqnarray*}
                \mathcal{R} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) y(t) & = & \mathcal{R} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) \\
                M \left( \frac{d}{dt} \right) \mathcal{R} \left( \frac{d}{dt} \right) y(t) & = & \mathcal{R} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) \\
                M \left( \frac{d}{dt} \right) \left( r(t) - \mathcal{S} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) \right) & = & \mathcal{R} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) \\
                \left( \mathcal{R} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) + M \left( \frac{d}{dt} \right) \mathcal{S} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) \right) u(t) & = & M \left( \frac{d}{dt} \right) r(t) \\
                \left( \mathcal{R} \left( \frac{d}{dt} \right) + M \left( \frac{d}{dt} \right) \mathcal{S} \left( \frac{d}{dt} \right) \right) N \left( \frac{d}{dt} \right) u(t) & = & M \left( \frac{d}{dt} \right) r(t) \\
            \end{eqnarray*}

            por lo que la ecuación~\ref{eq:anillos3} implica:

            \begin{equation}
                Q_E \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) = M \left( \frac{d}{dt} \right) r(t)
            \end{equation}

            por lo que los ceros del sistema, raices de $N(s)$, pasan a formar parte de los polos de la dimensión del controlador.

            Este esquema de control solo funcionará para sistemas de fase mínima, es decir, cuando $N(s)$ es un polinomio Hurwitz.

%-------------------------------------------------------------------------------

        \subsection{Asignación de polos sin cancelación de ceros}

            \begin{problema}
                Se desea encontrar una ley de control, tal que el sistema en lazo cerrado este representado por la ecuación diferencial ordinaria:

                \begin{equation}
                    Q_D \left( \frac{d}{dt} \right) y(t) = N \left( \frac{d}{dt} \right) r(t)
                \end{equation}

                donde $Q_D(s) \in \mathbb{R}[s]$ es un polinomio Hurwitz dado y $r(t)$ es la señal de referencia.
            \end{problema}

            Para obtener la ley de control, se tiene que resolver la ecuación Diofantina (~\ref{eq:anillos0}), se asume que los polinomios de $M(s)$ y $N(s)$ son primos relativos, es decir $(M, N) = 1$.

            Para esto se supone la siguiente ley de control lineal:

            \begin{equation} \label{eq:anillos4}
                \mathcal{S} \left( \frac{d}{dt} \right) u(t) = - \mathcal{R} \left( \frac{d}{dt} \right) y(t) + r(t)
            \end{equation}

            donde $\mathcal{S}(s), \mathcal{R}(s) \in \mathbb{R}[s]$, son solución de la ecuación Diofantina:

            \begin{equation} \label{eq:anillos5}
                \mathcal{S}(s) M(s) + \mathcal{R}(s) N(s) = Q_D(s)
            \end{equation}

            En efecto, aplicando el operador $\mathcal{S} \left( \frac{d}{dt} \right)$ a la ecuación~\ref{eq:anillos1} y sustituyendo la ecuación~\ref{eq:anillos4}, obtenemos:

            \begin{eqnarray*}
                \mathcal{S} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) y(t) & = & \mathcal{S} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) \\
                & = & N \left( \frac{d}{dt} \right) \mathcal{S} \left( \frac{d}{dt} \right) u(t) \\
                & = & N \left( \frac{d}{dt} \right) \left( -\mathcal{R} \left( \frac{d}{dt} \right) y(t) + r(t) \right) \\
                & = & -N \left( \frac{d}{dt} \right) \mathcal{R} \left( \frac{d}{dt} \right) y(t) + N \left( \frac{d}{dt} \right) r(t) \\
                \left( \mathcal{S} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) + N \left( \frac{d}{dt} \right) \mathcal{R} \left( \frac{d}{dt} \right) \right) & = & N \left( \frac{d}{dt} \right) r(t) \\
                Q_D \left( \frac{d}{dt} \right) y(t) & = & N \left( \frac{d}{dt} \right) r(t)
            \end{eqnarray*}

            por lo que hemos llegado a la ley de control que esperabamos.

            Con respecto a la dinámica de la entrada, aplicando el operador $\mathcal{R}\left( \frac{d}{dt} \right)$ a la ecuación~\ref{eq:anillos1} y sustituyendo la ecuación~\ref{eq:anillos4}, obtenemos:

            \begin{eqnarray*}
                \mathcal{R} \left( \frac{d}{dt} \right) M \left( \frac{d}{dt} \right) y(t) & = & \mathcal{R} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) u(t) \\
                M \left( \frac{d}{dt} \right) \mathcal{R} \left( \frac{d}{dt} \right) y(t) & = & \\
                M \left( \frac{d}{dt} \right) \left( -\mathcal{S} \left( \frac{d}{dt} \right) u(t) + r(t) \right) & = & \\
                \left( M \left( \frac{d}{dt} \right) \mathcal{S} \left( \frac{d}{dt} \right) + \mathcal{R} \left( \frac{d}{dt} \right) N \left( \frac{d}{dt} \right) \right) u(t) & = & M \left( \frac{d}{dt} \right) r(t)
            \end{eqnarray*}

            por lo que llegamos a:

            \begin{equation}
                Q_D \left( \frac{d}{dt} \right) u(t) = M \left( \frac{d}{dt} \right) r(t)
            \end{equation}

            Note ahora que tanto la salida como la entrada tienen la misma dinámica dada por el polinomio Hurwitz seleccionado, $Q_D(s)$.

            Note tambien que la salida continua con los mismos ceros determinados por $N(s)$.

            Este esquema de control sirve tanto para sistemas de fase mínima, como para sistemas de fase no mínima.

            Ahora bien, para resolver la ecuación Diofantina, se utiliza la matriz de Sylvester; consideremos por ejemplo:

            \begin{eqnarray} \label{eq:anillos6}
                M(s) & = & s^3 + a_1 s^2 + a_2 s + a_3 \nonumber \\
                N(s) & = & b_0 s^3 + b_1 s^2 + b_2 s + b_3 \nonumber \\
                \mathcal{R}(s) & = & r_0 s^2 + r_1 s + r_2 \nonumber \\
                \mathcal{S}(s) & = & s_0 s^2 + s_1 s + s_2 \nonumber \\
                Q_D(s) & = & q_0 s^5 + q_1 s^4 + q_2 s^3 + q_3 s^2 + q_4 s + q_5
            \end{eqnarray}

            Note que:

            \begin{eqnarray}
                \grado{M(s)} & = & n \nonumber \\
                \grado{N(s)} & \le & n \nonumber \\
                \grado{\mathcal{R}(s)} & < & n \nonumber \\
                \grado{\mathcal{S}(s)} & < & n \nonumber \\
                \grado{Q_D(s)} & < & 2n
            \end{eqnarray}

            Sustituyendo las ecuaciónes~\ref{eq:anillos6} en la ecuación~\ref{eq:anillos5} e igualando los coeficientes de los mismos monomios $s^i$ con $i \in {1, 2, \dots, n}$, se obtiene la siguiente expresión matricial.

            \begin{equation*}
                \mathcal{S}(s) M(s) + \mathcal{R}(s) N(s) = Q_D(s)
            \end{equation*}

            \begin{multline*}
                (s_0 s^2 + s_1 s + s_2)(s^3 + a_1 s^2 + a_2 s + a_3) \\
                + (r_0 s^2 + r_1 s + r_2)(b_0 s^3 + b_1 s^2 + b_2 s + b_3) \\
                = q_0 s^5 + q_1 s^4 + q_2 s^3 + q_3 s^2 + q_4 s + q_5
            \end{multline*}

            \begin{multline*}
                s^{5} \left( s_{0} + b_{0} r_{0} \right) + s^{4} \left( s_{1} + a_{1} s_{0} + b_{0} r_{1} + b_{1} r_{0} \right) \\
                + s^{3} \left( s_{2} + a_{1} s_{1} + a_{2} s_{0} + b_{0} r_{2} + b_{1} r_{1} + b_{2} r_{0} \right) \\
                + s^{2} \left( a_{1} s_{2} + a_{2} s_{1} + a_{3} s_{0} + b_{1} r_{2} + b_{2} r_{1} + b_{3} r_{0} \right) \\
                + s \left( a_{2} s_{2} + a_{3} s_{1} + b_{2} r_{2} + b_{3} r_{1} \right) + a_{3} s_{2} + b_{3} r_{2}\\
                = q_0 s^5 + q_1 s^4 + q_2 s^3 + q_3 s^2 + q_4 s + q_5
            \end{multline*}

            \begin{eqnarray*}
                q_0 & = & s_{0} + b_{0} r_{0} \\
                q_1 & = & s_{1} + a_{1} s_{0} + b_{0} r_{1} + b_{1} r_{0} \\
                q_2 & = & s_{2} + a_{1} s_{1} + a_{2} s_{0} + b_{0} r_{2} + b_{1} r_{1} + b_{2} r_{0} \\
                q_3 & = & a_{1} s_{2} + a_{2} s_{1} + a_{3} s_{0} + b_{1} r_{2} + b_{2} r_{1} + b_{3} r_{0} \\
                q_4 & = & a_{2} s_{2} + a_{3} s_{1} + b_{2} r_{2} + b_{3} r_{1} \\
                q_5 & = & a_{3} s_{2} + b_{3} r_{2}
            \end{eqnarray*}

            es decir:

            \begin{equation*}
                \begin{pmatrix}
                    1 & 0 & 0 & b_{0} & 0 & 0 \\
                    a_{1} & 1 & 0 & b_{1} & b_{0} & 0 \\
                    a_{2} & a_{1} & 1 & b_{2} & b_{1} & b_{0} \\
                    a_{3} & a_{2} & a_{1} & b_{3} & b_{2} & b_{1} \\
                    0 & a_{3} & a_{2} & 0 & b_{3} & b_{2} \\
                    0 & 0 & a_{3} & 0 & 0 & b_{3}
                \end{pmatrix}
                \begin{pmatrix}
                    s_0 \\
                    s_1 \\
                    s_2 \\
                    r_0 \\
                    r_1 \\
                    r_2
                \end{pmatrix} =
                \begin{pmatrix}
                    q_0 \\
                    q_1 \\
                    q_2 \\
                    q_3 \\
                    q_4 \\
                    q_5
                \end{pmatrix}
            \end{equation*}

            \begin{equation} \label{eq:anillos7}
                S(M, N)
                \begin{pmatrix}
                    \mathcal{S} \\
                    \mathcal{R}
                \end{pmatrix} =
                Q_D
            \end{equation}

            MacDuffee demostró que la matriz de Sylvester, $S(M, N)$, es invertible si y solo si los polinomios son primos relativos, o equivalentemente, si y solo si el sistema es controlable.

%-------------------------------------------------------------------------------
%	EMPIEZA SECCION
%-------------------------------------------------------------------------------

    \newpage
    \section{Ejemplo}

        Consideremos nuevamente el sistema representado por la ecuación~\ref{eq:anillos1}, en donde:

        \begin{equation*}
            M(s) = (s+1)(s^2 + s + 1) = s^3 + 2 s^2 + 2 s +1
        \end{equation*}

        \begin{equation*}
            N(s) = 2(s+a) = 2s  + 2a
        \end{equation*}

        Por lo que la matriz de Silvester tiene la siguiente forma:

        \begin{equation*}
            S(M,N) =
            \begin{pmatrix}
                1 & 0 & 0 & 0 & 0 & 0 \\
                2 & 1 & 0 & 0 & 0 & 0 \\
                2 & 2 & 1 & 2 & 0 & 0 \\
                1 & 2 & 2 & 2a & 2 & 0 \\
                0 & 1 & 2 & 0 & 2a & 2 \\
                0 & 0 & 1 & 0 & 0 & 2a
            \end{pmatrix}
        \end{equation*}

        Note que:

        \begin{equation*}
            \det{S(M, N)} = -8 (-a + 1) (a^2 -a +1)
        \end{equation*}

        por lo que $S(M, N)$ será singular cuando la raiz de $N(s) = 2 (s + a)$, es también la raiz de $M(s) = (s + 1)(s^2 + s + 1)$, es decir, tendrá una única solución cuando $M(s)$ y $N(s)$ son primos relativos.

        Note que la matriz inversa de $S(M, N)$ toma la siguiente forma:

        \begin{equation*}
            S^{-1}(M, N) =
            \begin{pmatrix}
                1 & 0 & 0 & 0 & 0 & 0 \\
                -2 & 1 & 0 & 0 & 0 & 0 \\
                * & * & * & * & * & * \\
                * & * & * & * & * & * \\
                * & * & * & * & * & * \\
                * & * & * & * & * & *
            \end{pmatrix}
        \end{equation*}

        donde $*$ son elementos no cero, por lo que de la ecuación~\ref{eq:anillos7} se observa, que para que el controlador:

        \begin{equation*}
            \hat{u}(s) = - \frac{\mathcal{R}(s)}{\mathcal{S}(s)} \hat{y}(s) + \frac{1}{\mathcal{S}(s)} \hat{r}(s)
        \end{equation*}

        sea propio, se debe cumplir que:

        \begin{equation*}
            \grado{\mathcal{S}}(s) \ge \grado{\mathcal{R}}(s)
        \end{equation*}

        y que el coeficiente $q_0$ no debe ser $0$, esto es:

        \begin{equation*}
            \grado{Q_D(s)} = 2 \grado{M(s)} - 1
        \end{equation*}

        es decir, el exceso de grado, $\grado{M(s)} - 1$, corresponde al observador de estado, que está implicitamente considerado en la descripción polinomial $N(s) M(S)$, con $(M(s), N(s)) = 1$, es decir en la realización controlable y observable.
